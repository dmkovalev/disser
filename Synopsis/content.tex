\pdfbookmark{Общая характеристика работы}{characteristic}             % Закладка pdf
\section*{Общая характеристика работы}

\newcommand{\actuality}{\pdfbookmark[1]{Актуальность}{actuality}\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\pdfbookmark[1]{Разработанность темы}{progress}\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\pdfbookmark[1]{Цели}{aim}\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\pdfbookmark[1]{Задачи}{tasks}\underline{\textbf{\tasksTXT}}}
\newcommand{\aimtasks}{\pdfbookmark[1]{Цели и задачи}{aimtasks}\aimtasksTXT}
\newcommand{\novelty}{\pdfbookmark[1]{Научная новизна}{novelty}\underline{\textbf{\noveltyTXT}}}
\newcommand{\influence}{\pdfbookmark[1]{Практическая значимость}{influence}\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\pdfbookmark[1]{Методология и методы исследования}{methods}\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\pdfbookmark[1]{Положения, выносимые на защиту}{defpositions}\underline{\textbf{\defpositionsTXT}}}
\newcommand{\reliability}{\pdfbookmark[1]{Достоверность}{reliability}\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\pdfbookmark[1]{Апробация}{probation}\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\pdfbookmark[1]{Личный вклад}{contribution}\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\pdfbookmark[1]{Публикации}{publications}\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов \dots

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\pdfbookmark{Содержание работы}{description}                          % Закладка pdf
\section*{Содержание работы}
Во \underline{\textbf{введении}} обосновывается актуальность
исследований, проводимых в~рамках данной диссертационной работы,
приводится обзор научной литературы по~изучаемой проблеме,
формулируется цель, ставятся задачи работы, излагается научная новизна
и практическая значимость представляемой работы, приводятся положения, выносимые на защиту.

% В~последующих главах
% сначала описывается общий принцип, позволяющий \dots, а~потом идёт
% апробация на частных примерах: \dots  и~\dots.


\underline{\textbf{Первая глава}} посвящена рассмотрению роли гипотез, моделей и экспериментов в исследованиях 
с интенсивным использованием данных. В ней изложена историческая перспектива гипотезо-ориентированных исследований,
исследуются методы оперирования гипотезами с применением средств информатики в процессе экспериментального 
изучения и моделирования различных явлений, подчеркивается мысль о том, что наукам, интенсивно использующим данные, 
и тем, которые опираются на гипотезы, необходимы новые подходы.

Далее рассмотрены различные способы представления научных гипотез, методы проверки гипотез на основе как частотной,
так и Байесовской статистики, математической логики,
сравнения нескольких гипотез между собой, методы проведения оценки параметров моделей, реализующих гипотезы, а также 
подходы к порождению гипотез в научных экспериментах. Показано, что гипотезо-ориентированные системы играют весомую 
роль в современных научных исследованиях. 

Оставшаяся часть первой главы посвящена рассмотрению средств поддержки экспериментов, движимых научными гипотезами. 
Среди них исследуются как гипотезо-ориентированные (<<Робот-ученый>>, <<Гефест>>, $\Upsilon$-DB, FCCE, SDI), 
так и нет (MLCask, MLFlow, Dagster, MLDev). Анализ показывает, 
что существующие системы не охватывают несколько важных вопросов, в том числе взаимодействие между гипотезами в 
одном эксперименте, отслеживание эволюции эксперимента, восприятие автоматически полученных гипотез и формул экспертами.

В результате анализа существующих систем поддрежки гипотезо-ориентированных исследований подчеркнуто, что исследованиям 
с интенсивным использованием данных, опирающимся на гипотезы, необходимы новые подходы, 
сформулированы общие требования к системе для управления виртуальными экспериментами:
\begin{enumerate}
    \item Отслеживание эволюции моделей, гипотез и экспериментов. 
            Должны быть определены операции управления виртуальными экспериментами и их составляющими 
            (гипотезы, модели, их конфигурации и пр.).
    \item Обеспечение явной спецификации зависимостей между гипотезами (например, конкурирующие гипотезы, одна гипотеза 
            выведена из другой), автоматического извлечения зависимостей между гипотезами. Использование полученных 
            зависимостей при принятии решения, от каких конфигураций экспериментов следует заранее 
            отказаться. Так, например, некоторые сочетания гипотез и/или их параметров могут приводить к противоречию с 
            базовыми физическими законами (также определенными как гипотезы в виртуальном эксперименте). Необходима 
            также предварительная идентификация и фильтрация виртуальных эксперименты с предсказуемо плохо 
            соответствующим наблюдениям результатом.
    \item Обеспечение ранжирования экспериментов и конкурирующих гипотез по соответствию наблюдаемым данным на 
            одном или нескольких наборах данных. Вычисление метрики соответствия, используемой для принятия решения об 
            отказе от эксперимента, плохо соответствующем наблюдениям, на новом наборе данных (при этом происходит 
            ограничение количества возможных экспериментов).
    \item Предоставление структур для хранения результатов предыдущих экспериментов, и обеспечение запросов к ним. 
            План проведения экспериментов должен быть сформирован таким образом, чтобы сохраненные результаты по 
            возможности использовались, и никаких повторных вычислений не производилось.
    \item Повторное использование программ и данных компьютерами, а также воспроизводимость экспериментов требует использования формальных спецификаций предметных областей данных, а также 
            поддержки автоматического логического вывода. Разработка формальных концептуальных спецификаций в научных 
            сообществах стимулируется необходимостью достижения семантической интероперабельности между коллекциями 
            данных и компонентами. 
    \item Система должна быть модульной и функционально расширяемой, а также должна поддерживать связность с другими 
            компонентами глобальной системы, в рамках которой она реализуется.
\end{enumerate}

\underline{\textbf{Во второй главе}} был предложен новый метод управления виртуальным экспериментом 
в гипотезо-ориентированных ИИИД. Используется следущее определение виртуального эксперимента:

 \textit{Определение 1.} \textit{Виртуальный эксперимент} в рамках исследований определяется как 
кортеж $<O, H, M, R, W, C>$, гдe
\begin{itemize}
    \item $O$ "--- это онтология предметной области. Онтология предметной области представляет собой набор понятий и 
            отношений в прикладной области, формально заданных с помощью некоторого языка.
    \item $H$ "--- это набор спецификаций гипотез и взаимосвязей между ними. H является частью онтологии и использует 
            концепции из нее. Вместе они формируют онтологию виртуального эксперимента. Гипотеза "--- это предлагаемое 
            объяснение явления, которое еще предстоит тщательно проверить. 
    \item $M$ "--- это набор моделей. Каждая модель представляет собой набор функций. Каждая модель реализует 
            спецификацию гипотезы. Если модель генерирует ожидаемое поведение какого-либо явления, то говорят, что 
            модель и соответствующая гипотеза подтверждаются наблюдениями.
    \item $R: H \to M$ "--- это отображение из набора гипотез в модели.
    \item $W$ "--- это поток работ. Поток работ представляет собой набор задач, организованных определенными 
            конструкциями (шаблоны рабочего процесса "--- разделение, объединение и т.д.). Каждая задача представляет 
            собой функцию с предопределенной сигнатурой, которая вызывает модели из $M$. Рабочий процесс реализует 
            эксперимент, указывающий, когда следует вызывать каждую модель, соответствующую соответствующим гипотезам. 
    \item $C$ - это конфигурация для каждого запуска эксперимента. Он состоит из полного сопоставления задач 
            рабочего процесса с наборами значений параметров функций.
\end{itemize}

Жизненный цикл виртуального эксперимента состоит из четырех этапов и приведен на \cref{fig:lifecycle_ve}. 
\begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\linewidth]{images/ve_cycle.pdf}
    \caption{Жизненный цикл виртуального эксперимента.}\label{fig:lifecycle_ve}
\end{figure}

На первом этапе происходит инициализация виртуального эксперимента: определение онтологии предметной области, 
определение гипотез и соответствующих им моделей, определение потока работ для исполнения виртуального эксперимента, 
задание конфигурации эксперимента. Поток работ также определяется как направленный ациклический граф. Вершины такого 
графа называются задачами, а каждая задача рассматривается как программа, вызывающая функции, реализующие гипотезы.

На втором этапе по желанию пользователя происходит автоматическое порождение дополнительных гипотез из данных. 
После загрузки виртуального эксперимента в систему происходит автоматическое построение решетки гипотез виртуального 
эксперимента. Используется представление гипотез как специальных структур данных, сочетающих равенства, входящие в 
них переменные и причинно-следственные отображения над ними. Решетка гипотез определяется как направленный ациклический 
граф с вершинами, отвечающими гипотезам. Ребра графа соответствуют отношению завимости между гипотезами, когда 
результат вычислений одной гипотезы используется в вычислениях другой гипотезы. Конструирование решеток отношений 
между гипотезами способствует повышению эффективности управления виртуальными экспериментами, в частности, ускорению 
вычислений с использованием промежуточных результатов, относящихся к независимым гипотезам. 

На третьем этапе происходит построение оптимального плана исполнения нескольких экспериментов. 

На четвертом этапе происходит непосредственное исполнение одного или нескольких виртуальных экспериментов, при этом 
система отслеживает, есть ли в базе данных метаинформации сохраненные результаты исполнения отдельных функций 
эксперимента при заданных параметрах и подставляет их, если совпадение найдено. После исполнения виртуального 
эксперимента результат возвращается эксперту. 

Далее предствален алгоритмы построения решетки гипотез, построение плана виртуального эксперимента и 
проверки его корректного определения. 

\textit{Определение 2.} Решетка гипотез $L$ представляет собой ориентированный ациклический граф, вершины которого 
соответствуют гипотезам с некоторой структурой $S$, а ребра соответствуют отношению $derived\_by$  между гипотезами. 
Отношение $derived\_ by\left(b, a\right)$ означает, что результат вычисления гипотезы $b$ используется при вычислении 
гипотезы $a$.

Разработанный алгоритм построения решетки гипотез в виртуальных экспериментах представлен в алгоритме
\ref{alg:build_lattice}. На входе алгоритм принимает поток работ $W$ и набор гипотез $H$. 
Если поток работ ссылается на гипотезу, которая не представлена в $H$, алгоритм возвращает ошибку. 
В противном случае возвращается решетка гипотезы $L$.  

Задачи потока работ рассматриваются одна за другой в соответствии с порядком, определяемым направлением ребер. 
Для каждой пары гипотез $h_i, h_j$, где $h_i$ упоминается в текущей задаче, а $h_j$ упоминается в некоторой задаче, 
достижимой из текущей задачи, строится транзитивное замыкание для объединения структур соответствующих гипотез. 
После этого все такие транзитивные замыкания объединяются вместе в $C^+$. Структура результирующей решетки $L$ 
соответствует структуре $C^+$. В качестве вершин $L$ включает гипотезы, в которых встречаются переменные из $C^+$. 
Для каждой пары $\left(x_a, x_b\right)$ в $C^+$ \textit{L} включает ребро 
$derived\_by \left(\phi^{-1}\left(x_b\right), \phi^{-1}\left(x_a\right)\right)$.

\begin{algorithm}
    % \SetKwFunction{isOddNumber}{isOddNumber}
    % \SetKwInput{Input}{Input}
    % \SetKwInput{Output}{Output}
    % \SetKwInOut{KwIn}{Input}
    % \SetKwInOut{KwOut}{Output}


    \KwIn{$W$ "--- \texttt{поток работ}, $H$ "--- \texttt{гипотезы}.}
    \KwOut{$L$ "--- \texttt{решетка гипотез}.}

    \For{$h \in V(W)$}{
        \If{$h \notin H$}{
            \textbf{вернуть} \texttt{'Ошибка: гипотезы не найдены'} 
        }
    }
    
    $ C^+ \gets \varnothing $ 

    $\phi \gets \varnothing $ 

    $L \gets \varnothing $

    $ T \gets V\left(W\right) $

    \For{$t \in T$}{
        $T \gets T \setminus t$

        \For{$h_i \in t$}{
            \For{$remain\_t$ \texttt{в} $T$, \texttt{таких что} $remain\_t$ \texttt{достижим из $t$}}{
                \For{$h_i \in remain\_t$}{
                    $S_i \gets $ \texttt{структура для } $h_i$
                    
                    $S_j \gets $ \texttt{структура для } $h_j$
                    
                    \If{$S_i \cup S_{j}$ "--- \texttt{полная}}{ 
                        \texttt{построить транзитивное замыкание } $C_{ij}^+$ \texttt{для} $S_i \cup S_{j}$
                        $C^+ \gets C^+ \cup C_{i}^+ $
                    }
                }
            }
        }
    }

    $\phi \gets $ \texttt{полное причинно-следственное отображение для} $C^+$
    
    $ L \gets L_{inp}$ 
    \For{\texttt{пара} $\left( x_a, x_b \right) \in C^+$}{
    $ V\left(L\right) \gets V\left(L\right) \cup \{\phi^{-1} \left(x_a\right)\}
             \cup \{\phi^{-1} \left(x_b\right)\}$
    
    $ E \left(L\right) \gets E\left(L\right) \cup \{ derived\_by \left(\phi^{-1} \left(x_b\right), 
    \phi^{-1} \left(x_a\right) \right) \} $
    }

    \KwRet{$L$}
    \caption{Построение решетки гипотез}\label{alg:build_lattice}
\end{algorithm}

\textbf{Лемма 1.} Вычислительная сложность алгоритма построения решетки гипотез для потока работ $W$ и набора гипотез 
$H$ ограничена функцией $ O\left( |W|^2 * |S| * |V| * |H| \right)$, где 
$S = \bigcup\limits_{h \in H} S\left(E_h, V_h \right), V = \bigcup\limits_{h \in H} V_h$.

\textbf{Доказательство.} Самой вычислительно сложной операцией алгоритма является построение транзитивного замыкания. 
Так как алгоритм состоит из трех циклов, то максимальное количество операций транзитивного замыкания не превосходит 
$|W|^2*|H|$, где $|H|$ "--- общее количество гипотез. Сложность построения транзитивного замыкания не превосходит 
$O\left(|S|*|V|\right)$, поэтому вычислительная сложность алгоритма построения решетки гипотез ограничена 
$O\left(|W|^2*|H|*|S|*|V|\right)$.

Аналогично представлен алгоритм добавления новой гипотезы в существующую решетку.

Для корректного запуска виртуальный эксперимент должен быть \textit{непротиворечивым}. 
Для этого должны выполняться следующие условия:
\begin{enumerate}
    \item Должны быть опредены все элементы виртуального эксперимента $O, H, M, R, W, C$.
    \item Число гипотез должно быть не менее числа задач в потоке работ $|H| \geq |V(W)| $.
    \item Число моделей должно быть не менее числа гипотез $|M| \geq |H|$.
    \item Для каждой гипотезы должна быть опредена реализующая ее модель: $ \forall h \in H: \exists m \in M$ такой, 
            что $h \rightarrow m \in R$.
    
    \item Для каждой задачи потока работ должен существовать набор значений параметров вызываемых функций 
            $ \forall t \in V(W): \exists c \in C$.
    \item После построения решетки гипотез запускается алгоритм проверки отсутствия 
            некорректных зависимостей гипотез в потоке работ.
\end{enumerate}

Если нарушено условие 1), то платформа не сможет запустить выполнение виртуального эксперимента.
При нарушении условия 2) у некоторых задач потока работ будут отсутствовать соответствующие им гипотезы, что не 
позволит корректно построить решетку гипотез. При нарушении условия 3) и 4) некоторым гипотезам не будут 
сопоставлены модели, следовательно их будут невозможно исполнить. Условие 5) гарантирует, что для каждой модели 
существуют параметры ее запуска. Условие 6) необходимо для избежания циклов в графе потока работ, что приведет к 
некорректному построению решетки гипотез. Если гипотеза используется в задаче потока работ, то она не может быть 
использована в других задач, достижимых из этой. 

В алгоритме \ref{alg:plan} представлено построение плана виртуального эксперимента. На вход алгоритм принимает 
конфигурацию эксперимента, решетку гипотез, а на выходе возвращает два набора гипотез, модели для которых требуют или 
не требуют пересчета.



\begin{algorithm}
    \SetKwFunction{isOddNumber}{isOddNumber}
    % \SetKwInput{Input}{Input}
    % \SetKwInput{Output}{Output}
    % \SetKwInOut{KwIn}{Input}
    % \SetKwInOut{KwOut}{Output}

    \KwIn{$C$ "--- \texttt{конфигурация эксперимента}, $L$ "--- \texttt{решетка гипотез}.}
    \KwOut{$P_{ne}$ "--- \texttt{множество гипотез, для которых требуется пересчитать модели}, 
           $P_{e}$ "--- \texttt{прочие.}}

    $L_{n} \gets $ ближайшая для $L$ решетка в репозитории данных

    $P_{ne} \gets \varnothing , P_{e} \gets \varnothing $ 

    $F \gets \varnothing $

    $V \gets V(L_n)$

    % DFS 
    \For{$h \in V$}{ \Comment{начало с самой верхней гипотезы}
        \If{$\forall c_m \in C, \forall m \in M \  \alpha \  s.t.\  \nexists h \to m(c_m)$}{
            \Comment{в репозитории нет вычисленной части эксперимента}
            $H_{dep} \gets $ все зависимые гипотезы от $h$
            
            $P_{ne} \gets P_{ne}  \cup H_{dep} \cup h$

            $F \gets F \cup H_{dep} \cup h$
        }
        \Else{
            \Comment{в репозитории есть вычисленный фрагмент}

            $P_{e} \gets P_{e} \cup h$

            $F \gets F \cup h$
        }
        
        $V \gets V \setminus F $
    }
        
    \KwRet{$P_{ne}, P_{e}$}
    \caption{Построение плана виртуального эксперимента}\label{alg:plan}
\end{algorithm}

Сначала ищется ближайщая решетка, которая уже была вычисленна. После этого происходит поиск в глубину, начиная с 
гипотезы, у которой нет входных ребер. Если для всех параметров из конфигурации, для всех моделей не существует 
реализации гипотезы, то тогда гипотеза не имеет соответствующей вычисленной части и требует вычисления. Также 
требуется пересчитать модели, соответствующие всем зависимым гипотезам. Все вершины с этими гипотезами 
не требуется обходить. Иначе можно не пересчитывать соответствующий фрагмент и перейти к следующей вершине. 

Дополнительно могут быть определены эвристики для отказа от вычислительных маршрутов. Например, такой эвристикой может 
быть следующая: если коэффициент детерминации модели, реализующей гипотезу, не достигает 0.7, то требуется прекратить
вычисления и отказаться от этого вычислительного маршрута.

% \begin{algorithm}
%     \SetKwFunction{isOddNumber}{isOddNumber}
%     % \SetKwInput{Input}{Input}
%     % \SetKwInput{Output}{Output}
%     % \SetKwInOut{KwIn}{Input}
%     % \SetKwInOut{KwOut}{Output}

%     \KwIn{$W$ "--- \texttt{поток работ}, $L_{inp}$ "--- \texttt{решетка гипотез}.}
%     \KwOut{\textit{True} "--- \texttt{некорректные зависимости отсутствуют,} \textit{False} "--- \texttt{иначе}.}

%     \textit{correct} $\gets$ \textit{True}

%     \For{$t \in V(W)$}{  \Comment{задачи перебираются последовательно}

%         \For{$h \in t$}{\Comment{проверяются все гипотезы из задачи}
%             \texttt{найти все зависимые $\{h_d\} \in V(L_{inp})$ от $h$ }
            
%             \For{\texttt{$remaining\_task$ достижимых из $t$}}{

%                 \If{$\{h_d\} \cap H_t \neq \emptyset\  \alpha\  s.t.\  H_t \in remaining\_task$}{
%                     \Comment{Эксперимент определен некорректно}

%                     correct $\gets$ \textit{False}   
%                 }
%             }
%         }
%     }
%     \KwRet{correct}
%     \caption{Проверка отсутствия некорректных зависимостей гипотез в потоке работ}\label{alg:consistence}
% \end{algorithm}

\underline{\textbf{Третья глава}} посвящена разработке и реализации платформы проведения виртуального 
эксперимента и то, каким образом ее архитектуры поддерживают различные этапы деятельности эксперта 
по проведению виртуальных экспериментов. На рисунке \cref{fig:arch} пунктирные стрелки обозначают доступ из одного 
компонента к интерфейсу другого компонента. Программная 
архитектура системы исполнения виртуального эксперимента включает в себя компоненты, поддерживающие различные этапы 
проведения виртуальных экспериментов. 

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.7\linewidth]{images/arch_v4.pdf}
    \caption{Архитектура платформы исполнения виртуальных экспериментов.}\label{fig:arch}
\end{figure}

Разработанный программный комплекс платформы управления виртуальными экспериментами нацелен на объединение 
преимуществ и преодоление недостатков существующих систем. На основании анализа предметной области управления 
виртуальными экспериментами и родственных работ формализовано общее понятие виртуального эксперимента, включающее 
онтологию предметной области, набор спецификаций гипотез и взаимосвязей между ними, набор моделей, реализующих 
гипотезы, поток работ, реализующий эксперимент, конфигурацию (набор значений параметров) эксперимента. Сформулированы 
общие требования к системе для управления виртуальными экспериментами, которым удовлетворяет реализованный прототип. 
Отслеживается эволюция моделей, гипотез и экспериментов. На основании анализа методов формального манипулирования 
виртуальными экспериментами и гипотезами при сохранении непротиворечивости экспериментов для систем с явным 
представлением и использованием гипотез выбраны и реализованы операции управления виртуальными экспериментами и 
их составляющими (гипотезы, модели, их конфигурации). Реализованы методы ранжирования конкурирующих гипотез по 
соответствию наблюдаемым данным на одном или нескольких наборах данных. Предоставляются структуры для хранения 
результатов предыдущих экспериментов, и обеспечиваются запросы к ним. Реализован метод автоматизированного построения 
решеток причинно-следственных зависимостей гипотез в виртуальных экспериментах. Реализован метод порождения гипотез 
из данных, сочетающий обобщенную линейную модель, генетическое программирование и динамическое причинно-следственное 
моделирование. Разработаны и реализованы метод поиска оптимальных параметров гипотез и метод корректной оценки 
соответствия гипотезы исследуемому явлению. Реализован метод повышения эффективности и скорости проведения виртуальных 
экспериментов. Реализованы методы сравнения конкурирующих гипотез, построенных из данных, с теоретическими гипотезами 
из теоретического моделирования или литературы. Реализован подход к интеграции экспериментов, гипотез и данных с 
данными новых наблюдений, симуляций и метаданных экспериментов.

Определен отдельный ядровой модуль \textit{Core}, содержащий классы, соответствующие ключевым понятиям, используемым при работе 
с платформой "--- виртуальный эксперимент, гипотеза, модель, поток работ, конфигурация. Дополнительно определены 
вспомогательные классы переменной, уравнения, структуры, решетки гипотез, полного причинно-следственного отображения, 
множества зависимых переменных и их транзитивного замыкания. 

Компонент \textit{MetadataRepository} представляет собой репозиторий метаинформации (базу данных), предназначенный для хранения 
результатов выполнения виртуального эксперимента с учетом накопления данных о добавлении, модификации и удалении 
гипотез, потоков работ, онтологий и виртуальных экспериментов. Дополнительно в репозитории сохраняются построенные 
зависимости между гипотезами (полученными либо от эксперта, либо автоматически извлеченные) и имеющейся информации 
о корреляции между параметрами как в рамках одной, так и параметров нескольких гипотез.

Компонент VirtualExperimentManager представляет пользователю интерфейс с операциями формального манипулирования 
виртуальными экспериментами и гипотезами. После загрузки виртуального эксперимента в систему его спецификация 
сохраняется в базу данных. Далее, по запросу эксперта происходит вызов компонента автоматического порождения 
гипотез из данных \textit{HypothesisGenerator}. После этого автоматически происходит вызов компонента 
\textit{HypothesisLatticesConstructor} для построения решетки гипотез виртуального эксперимента. Далее вызывается компонент 
\textit{VirtualExperimentPlanner}, отвечающий за построение плана исполнения виртуального эксперимента. Построенный план 
сохраняется в базу данных. Наконец, происходит вызов компонента \textit{VirtualExperimentRunner}, ответственного за 
непосредственное исполнение виртуального эксперимента. Компонент поддерживает одновременное управление 
несколькими экспериментами.

Компонент \textit{HypothesisGenerator} по запросу эксперта обеспечивает автоматическое построение гипотез по данным в виде 
нелинейных функциональных зависимостей. В качестве основного метода используется символьная регрессия, обеспечивающая 
интерпретируемость полученных формул. Эксперту вместе с системой уравнений возвращается оценка качества соответствия 
данным, по которой принимается решение об использовании построенной гипотезы. Для построения функциональной зависимости 
между переменными в данных используется реализация символьной регрессии на основе генетического программирования 
с арифметическими и тригонометрическими операциями. 

Компонент \textit{COAConstructor} позволяет построить причинно-следственный граф зависимостей переменных одной гипотезы. 
Компонент включает механизм вероятностного вывода, позволяющего отследить не только причинно-следственные связи между 
гипотезами, но и неявные зависимости, например, значимые корреляции между параметрами гипотез, не связанных 
причинно-следственными зависимостями.

Компонент \textit{HypothesisLatticesConstructor} обеспечивает автоматическое построение решеток гипотез по соответствующим 
им системам уравнений. Компонент загружает из базы данных метаинформации спецификацию потока работ и гипотез. 
Далее системы уравнений, соответствующих гипотезам, из спецификации переводятся во внутреннее представление, 
после чего вызывается компонент \textit{COAConstructor} для построения причинно-следственного графа зависимостей переменных. 
Решетка гипотез сохраняется в базу данных метаинформации.

Компонент \textit{VirtualExperimentRunner} запускается для непосредственного исполнения виртуального эксперимента. 
Из репозитория метаинформации загружаются спецификация виртуального эксперимента и дополнительно построенные 
решетка гипотез и план исполнения виртуального эксперимента. Исполнение происходит в соответствии с планом, при 
этом система использует сохраненные результаты исполнения части виртуального эксперимента (при их наличии в 
репозитории метаинформации). Используя спецификацию моделей виртуального эксперимента, компонент осуществляет 
вызов соответствующих функций, а затем собирает полученные данные от них. Результаты исполнения виртуального 
эксперимента сохраняются в базу данных метаинформации.

% Эксперименты по адаптации программной реализации нейросетевых моделей для выполнения в распределенной 
% вычислительной среде были проведены с использованием прототипа вычислительного кластера. Кластер включает в 
% себя главный узел и четыре вычислительных узла и развернут как часть инфраструктуры совместных исследовательских 
% объектов для высокопроизводительных вычислений ФИЦ ИУ РАН. 
% Взаимодействие платформы и кластера приведено на \cref{fig:platform_cluster}.

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.6\linewidth]{images/platform_cluster.pdf}
%     \caption{Запуск примера с использованием Платформы на кластере.}\label{fig:platform_cluster}
% \end{figure}

В \underline{\textbf{четвертой главе}} приведено описание сквозного примера задачи из нейрофизиологии,
связанной с поиском функциональной связности областей человеческого мозга над данными проекта Коннектома человека.
Разработаны программы, реализующие этот виртуальный эксперимент в ИИИД с использованием платформы.

Исследование функциональной связности в состоянии покоя имеет существенное значение, так как полученные результаты 
позволяют выделять нейросети покоя и анализировать их активность. Существует два типа функциональной связности 
головного мозга человека: линейная и нелинейная. В большинстве 
случаев исследуется лишь линейная функциональная связность. Хотя линейная модель проста и полезна в некоторых 
исследованиях, однако использование лишь линейных функций является сильным ограничением. Для автоматического 
восстановления нелинейных функциональных связей также используется метод генетического 
программирования. 

Задача поиска различий в работе головного мозга между мужчиной и женщиной уже давно интересует нейрофизиологов. 
Наиболее часто используются линейные модели. 
Их недостатком является применение лишь линейных методов для сравнения регионов 
(в основном это обычная корреляция Пирсона). При использовании нелинейной функциональной связности становится 
возможным более подробно исследовать взаимосвязь между регионами головного мозга и лучше понять его работу в целом. 
Исследование подходов к поиску значимых различий нелинейной функциональной связности головного мозга для мужчин и женщин 
в состоянии покоя является актуальной задачей, так как позволит выявить различия с помощью нелинейных методов. 
При использовании нелинейной функциональной связности становится возможным более подробно исследовать 
взаимосвязь между регионами головного мозга и лучше понять его работу в целом.

Визуализация, обработка и анализ многомерных данных, таких как изображения, часто требует некоторой предварительной 
обработки, для того чтобы уменьшить размерность данных и получить отображение исходно представленных данных на 
низкоразмерное векторное пространство. 
Такие преобразования называются выделением регионов головного мозга человека (ROI). 
В качестве переменных для построения зависимостей используются регионы головного мозга . ROI "--- это набор 
анатомически близких вокселей, представляющие маленькие кубики мозга. 
Выделение регионов можно рассматривать как один из способов уменьшения размерности. 
При использовании данного подхода регионы некоторым образом группируются и усредняются, а само усредненное значение 
является представительным значением для данного региона. Также при использовании данного метода делается предположение, 
что воксели одного региона ведут себя схожим образом. 
Распостранненым методом является использование карт мозга "--- атласов. При работе с атласами головного мозга человека 
используется заранее вычисленная функция, ставящая каждому вокселю изображения в соответствие регион головного мозга.

В соответствии с жизненным циклом виртуального эксперимента на первом этапе был специфицирован виртуальный 
эксперимент. В онтологии предметной области есть основные понятия, такие как человек, мозг, изображение, атлас и т.д. 
Простые свойства данных, такие как возраст, пол и пространственно-временные координаты, изображены в квадратах. 
Указываются подклассы со следующей конструкцией, например, взрослый среднего 
возраста "--- это взрослый, возраст которого составляет от 
30 до 45 лет, является подклассом взрослого (подкласс человека, где определяются возрастные и гендерные 
функциональные свойства).

После генерации систем уравнений специфицировано множество гипотез, соответствующих построенным системам уравнений, 
а также соответствующие им модели. Определен поток работ, задающий порядок вызова функций моделей, а также 
фиксирована конфигурация виртуального эксперимента. Произведен запуск виртуального эксперимента на исполнение.

По данным могут дополнительно генерироваться несколько конкурирующих гипотез, 
представленных как линейными, так и нелинейными моделями. Далее производится вычисление 
для всех моделей выбранной метрики (например, среднеквадратичной ошибки, коэффициента детерминации критериев 
Акаике и Байеса) для отсечения худших моделей с целью уменьшения в дальнейшем числа попарных сравнений моделей, 
а также для ранжирования моделей по выбранной метрике. Выбор метрики осуществляется экспертом. 

Следующим шагом является определение гипотез предметной области, моделей и сопоставления гипотез с моделями. 
Есть четыре гипотезы, которые уточняются. Первый описывает, как следует выделять регионы головного мозга (ROI). 
Три конкурирующие модели, которые используют три атласа, сопоставлены с этой первой гипотезой. 

Вторая конкретизированная гипотеза касается функциональной связности и того, как регионы мозга 
взаимодействуют друг с другом. 
Конкурирующие модели здесь линейные и нелинейные. Уравнения не указаны, и флаг для их генерации 
установлен в значение \textit{true}. 

Третья и четвертая гипотезы касаются существования значительных различий в функциональной связности у 
мужчин и женщин или у взрослых молодого и среднего возраста. Две конкурирующие модели для обеих гипотез "--- это 
модели разности уравнений и графов. Гипотезы и модели изображены на рисунке \cref{fig:Hypothesis_lattice}. 
Слева приведен граф зависимости нескольких гипотез между собой. 
Вершиной графа является набор конкурирующих между собой гипотез. Конкурирующими являются гипотезы, описывающие 
один и тот же феномен и реали-зованные различными вычислительными моделями. Приведенные методы сравнения работают 
для конкурирующих гипотез, для зависимых гипотез они не применимы.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\linewidth]{images/Hypothesis_Lattice.pdf}
    \caption{Решетка гипотез для задач поиска различий в функциональной связности.}\label{fig:Hypothesis_lattice}
\end{figure}

Система поддержки виртуальных экспериментов автоматически вычисляет множество экспериментов, сочетающих разные 
конкурирующие гипотезы. Проведено четыре виртуальных эксперимента (атлас выбирается вручную), с использованием 
двух типов моделей "--- линейных и нелинейных и двух типов разностей предсказаний.

Для данной задачи выделены три множества конкурирующих гипотез: выбор атласов и выделение регионов головного 
мозга человека, построение функциональной связности регионов головного мозга, поиск значимых различий в 
функциональной связности у мужчин и женщин в состоянии покоя. Для первого множества нет единого способа выбрать 
ту или иную модель. Для второго множества конкурирующих гипотез о функциональной связности регионов 
головного мозга используется несколько 
методов. Первым шагом для данного сравнения является отсечение моделей по пороговому значению коэффициента 
детерминации. Это делается для сокращения пространства сравниваемых моделей и отсечения моделей, плохо описывающих 
данные. Для 23 построены модели с оценкой 
выше порогового коэффициента детерминации, равным 0.7. Вторым шагом является сравнение линейных и нелинейных 
моделей, где нелинейные модели были получены методом генетического программирования. 
Для критерия Акаике лучшей моделью является нелинейная модель, то время, как для 
критерия Байеса лучшей моделью оказалась линейная модель \cref{fig:planning}.

Результаты сравнения различных гипотез и соответствующих им моделей приводится для задачи поиска различий в 
функциональной связности у мужчин и женщин в состоянии покоя. Здесь 
и далее результаты приводятся только для регионов \textit{Precentual Gyrus}, \textit{Postcentral Gyrus} 
и \textit{Planum Polare}. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\linewidth]{images/planning.pdf}
    \caption{Планирование эксперимента.}\label{fig:planning}
\end{figure}


\begin{table} [htbp]
    \centering
    \begin{threeparttable}% выравнивание подписи по границам таблицы
        \caption{Результаты сравнения двух построенных моделей для некоторых регионов головного мозга
                различными статистическими методами для проверки гипотезы о разности 
                нелинейной функциональной связности мужчин и женщин}\label{tab:Ts0Sib}%
        \begin{tabular}{| p{2.8cm} || p{3.5cm} || p{0.7cm} | p{3.2cm}l |}
            \hline
            \hline
            Регион   & \centering p-value & \centering $\eta$ & \centering  доказательная сила & \\
            \hline
            Precentual Gyrus & \centering  0.0045 (отвергается)   & \centering  29:1 & \centering      средняя    & \\
            Postcentral Gyrus  & \centering  0.0003 (отвергается) & \centering  54:1 & \centering      средняя    & \\
            Planum Polare & \centering  0.08 (не отвергается)     & \centering  7:1  & \centering      слабая     & \\
            \hline
            \hline
        \end{tabular}
    \end{threeparttable}
\end{table}



\FloatBarrier
\pdfbookmark{Заключение}{conclusion}                                  % Закладка pdf
В \underline{\textbf{заключении}} приведены основные результаты работы, которые заключаются в следующем:
\input{common/concl}

\pdfbookmark{Литература}{bibliography}                                % Закладка pdf
% При использовании пакета \verb!biblatex! список публикаций автора по теме
% диссертации формируется в разделе <<\publications>>\ файла
% \verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
    \renewcommand{\bibname}{\large \bibtitleauthor}
    \nocite{*}
    \insertbiblioauthor           % Подключаем Bib-базы
    %\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
    % Цитирования.
    %  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
    %  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
    %  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
    %
    % authorvak
    \nocite{kovalev2020multidisciplinary}%
    \nocite{kovalev2020architecture}%
    \nocite{tirikov2021methods}%
    % %
    % %% authorwos
    % \nocite{wosbib1}%
    % %
    %% authorscopus
    \nocite{kalinichenko2015methods}%
    \nocite{kovalev2017organization}%
    \nocite{kovalev2017search}%
    \nocite{kovalev2019constructing}%
    \nocite{kovalev2019virtual}%
    \nocite{kovalev2020methods}%
    % %
    % %% authorpathent
    % \nocite{patbib1}%
    %
    %% authorprogram
    \nocite{progbib1}%
    % %
    % %% authorconf
    % \nocite{confbib1}%
    % \nocite{confbib2}%
    % %
    % %% authorother
    % \nocite{bib1}%
    % \nocite{bib2}%

    \ifnumgreater{\value{usefootcite}}{0}{
        \begin{refcontext}[labelprefix={}]
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \end{refcontext}
    }{
        \ifnum \totvalue{citeexternal}>0
            \begin{refcontext}[labelprefix=A]
                \ifnum \value{bibgrouped}>0
                    \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
                \else
                    \insertbiblioauthor      % Вывод всех работ автора
                \fi
            \end{refcontext}
        \else
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \fi
        %  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
        \begin{refcontext}[labelprefix={}]
            \insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
        \end{refcontext}
        % Невидимый библиографический список для подсчёта количества внешних публикаций
        % Используется, чтобы убрать приставку "А" у работ автора, если в автореферате нет
        % цитирований внешних источников.
        \printbibliography[heading=nobibheading, section=0, env=countexternal, keyword=biblioexternal, resetnumbers=true]%
    }
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
